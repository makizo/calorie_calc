<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>BMI・基礎代謝計算ツール</title>
  <style>
    body { font-family: sans-serif; margin: 2em; }
    label { display: block; margin-top: 1em; }
    input, select { margin-top: 0.5em; }
    .result { margin-top: 2em; padding: 1em; border: 1px solid #ccc; }
  </style>
</head>
<body>
  <h1>BMI・基礎代謝計算ツール</h1>
  <form id="calcForm">
    <label>
      身長 (cm):
      <input type="number" id="height" required min="100" max="250" step="0.1">
    </label>
    <label>
      体重 (kg):
      <input type="number" id="weight" required min="20" max="200" step="0.1">
    </label>
    <label>
      年齢:
      <input type="number" id="age" required min="10" max="120">
    </label>
    <label>
      性別:
      <select id="gender" required>
        <option value="male">男性</option>
        <option value="female">女性</option>
      </select>
    </label>
    <label>
      活動レベル:
      <select id="activity" required>
        <option value="1.2">ほとんど運動しない（1.2）</option>
        <option value="1.375">軽い運動（週1-3日）（1.375）</option>
        <option value="1.55">中程度の運動（週3-5日）（1.55）</option>
        <option value="1.725">激しい運動（週6-7日）（1.725）</option>
        <option value="1.9">非常に激しい運動（1.9）</option>
      </select>
    </label>
    <br>
    <button type="submit">計算する</button>
  </form>

  <div class="result" id="result"></div>

  <script>
    document.getElementById('calcForm').addEventListener('submit', function(e) {
      e.preventDefault();

      // 入力値取得
      const height = parseFloat(document.getElementById('height').value);
      const weight = parseFloat(document.getElementById('weight').value);
      const age = parseInt(document.getElementById('age').value, 10);
      const gender = document.getElementById('gender').value;
      const activity = parseFloat(document.getElementById('activity').value);

      // BMI計算
      const heightM = height / 100;
      const bmi = weight / (heightM * heightM);

      // 適正体重範囲
      const minWeight = 18.5 * heightM * heightM;
      const maxWeight = 25 * heightM * heightM;

      // ハリスベネディクト方程式
      let bmrHarris;
      if (gender === 'male') {
        bmrHarris = 66.47 + (13.75 * weight) + (5.003 * height) - (6.755 * age);
      } else {
        bmrHarris = 655.1 + (9.563 * weight) + (1.850 * height) - (4.676 * age);
      }

      // Mifflin-St Jeor方程式
      let bmrMifflin;
      if (gender === 'male') {
        bmrMifflin = (10 * weight) + (6.25 * height) - (5 * age) + 5;
      } else {
        bmrMifflin = (10 * weight) + (6.25 * height) - (5 * age) - 161;
      }

      // 1日の推定消費カロリー
      const tdeeHarris = bmrHarris * activity;
      const tdeeMifflin = bmrMifflin * activity;

      // 結果表示
      document.getElementById('result').innerHTML = `
        <strong>【計算結果】</strong><br>
        <b>BMI：</b> ${bmi.toFixed(2)}<br>
        <b>適正体重範囲：</b> ${minWeight.toFixed(1)} kg ～ ${maxWeight.toFixed(1)} kg<br>
        <b>ハリスベネディクト方程式による基礎代謝量：</b> ${bmrHarris.toFixed(0)} kcal/日<br>
        <b>Mifflin-St Jeor方程式による基礎代謝量：</b> ${bmrMifflin.toFixed(0)} kcal/日<br>
        <b>ハリスベネディクト式の推定消費カロリー：</b> ${tdeeHarris.toFixed(0)} kcal/日<br>
        <b>Mifflin-St Jeor式の推定消費カロリー：</b> ${tdeeMifflin.toFixed(0)} kcal/日
      `;
    });
  </script>
</body>
</html>
