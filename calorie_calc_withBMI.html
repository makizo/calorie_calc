<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>BMI・基礎代謝計算ツール</title>
  <style>
    body { 
      font-family: sans-serif; 
      margin: 2em; 
      background-color: #f0f7f0; /* 薄い緑色の背景 */
      color: #333;
    }
    h1 {
      color: #006400; /* 濃い緑色のタイトル */
    }
    label { 
      display: block; 
      margin-top: 0.5em; 
      color: #004b00; /* 少し濃い緑色のラベル */
    }
    input[type="text"], select { 
      margin-top: 0.5em; 
      padding: 0.5em;
      border: 1px solid #a9d18e; /* 薄い緑色のボーダー */
      border-radius: 5px;
    }
    input[type="text"] { 
      width: 80px; 
      ime-mode: disabled;
    }
    .input-group {
      display: flex;
      align-items: center;
      margin-bottom: 0.5em;
    }
    .input-group label {
      display: inline-block;
      margin-right: 1em;
      width: 60px; /* ラベルの幅を調整 */
    }
    .gender-group { margin-left: 1em; }
    .gender-group label { display: inline; margin-right: 0.5em; width: auto; }
    .result { 
      margin-top: 2em; 
      padding: 1em; 
      border: 1px solid #a9d18e; /* 薄い緑色のボーダー */
      background-color: #e2f0d9; /* より薄い緑色の背景 */
      border-radius: 5px;
    }
    table { width: 50%; border-collapse: collapse; margin-top: 1em; }
    th, td { border: 1px solid #a9d18e; padding: 0.5em; text-align: center; }
    th { background-color: #c6e4b3; /* 少し濃い緑色のヘッダー */ }
    button {
      background-color: #4CAF50; /* 緑色のボタン */
      color: white;
      padding: 0.5em 1em;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background-color: #367c39; /* ホバー時の濃い緑色 */
    }
  </style>
</head>
<body>
  <h1>BMI・基礎代謝計算ツール</h1>
  <form id="calcForm" autocomplete="off">

    <div class="input-group">
      <label for="age">年齢:</label>
      <input type="text" id="age" required>
      <span class="gender-group">
        <input type="radio" id="male" name="gender" value="male" checked>
        <label for="male">男性</label>
        <input type="radio" id="female" name="gender" value="female">
        <label for="female">女性</label>
      </span>
    </div>

    <div class="input-group">
      <label for="height">身長 (cm):</label>
      <input type="text" id="height" required>
    </div>

    <div class="input-group">
      <label for="weight">体重 (kg):</label>
      <input type="text" id="weight" required>
    </div>

    <div class="input-group">
      <label for="activity">活動レベル:</label>
      <select id="activity" required>
        <option value="1.2">ほとんど運動しない（1.2）</option>
        <option value="1.375">軽い運動（週1-3日）（1.375）</option>
        <option value="1.55">中程度の運動（週3-5日）（1.55）</option>
        <option value="1.725">激しい運動（週6-7日）（1.725）</option>
        <option value="1.9">非常に激しい運動（1.9）</option>
      </select>
    </div>

    <br>
    <button type="submit">計算する</button>
  </form>

  <div class="result" id="result"></div>

  <script>
    document.getElementById('calcForm').addEventListener('submit', function(e) {
      e.preventDefault();

      // 入力値取得
      const height = parseFloat(document.getElementById('height').value);
      const weight = parseFloat(document.getElementById('weight').value);
      const age = parseInt(document.getElementById('age').value, 10);
      const gender = document.querySelector('input[name="gender"]:checked').value;
      const activity = parseFloat(document.getElementById('activity').value);

      // 入力値のバリデーション
      if (isNaN(height) || height <= 0) {
        alert('身長を正しく入力してください');
        return;
      }
      if (isNaN(weight) || weight <= 0) {
        alert('体重を正しく入力してください');
        return;
      }
      if (isNaN(age) || age <= 0) {
        alert('年齢を正しく入力してください');
        return;
      }

      // BMI計算
      const heightM = height / 100;
      const bmi = weight / (heightM * heightM);

      // 適正体重範囲
      const minWeight = 18.5 * heightM * heightM;
      const maxWeight = 25 * heightM * heightM;

      // ハリスベネディクト方程式
      let bmrHarris;
      if (gender === 'male') {
        bmrHarris = 66.47 + (13.75 * weight) + (5.003 * height) - (6.755 * age);
      } else {
        bmrHarris = 655.1 + (9.563 * weight) + (1.850 * height) - (4.676 * age);
      }

      // Mifflin-St Jeor方程式
      let bmrMifflin;
      if (gender === 'male') {
        bmrMifflin = (10 * weight) + (6.25 * height) - (5 * age) + 5;
      } else {
        bmrMifflin = (10 * weight) + (6.25 * height) - (5 * age) - 161;
      }

      // 1日の推定消費カロリー
      const tdeeHarris = bmrHarris * activity;
      const tdeeMifflin = bmrMifflin * activity;

      // 結果表示
      document.getElementById('result').innerHTML = `
        <strong>【計算結果】</strong><br>
        <b>BMI：</b> ${bmi.toFixed(2)}<br>
        <b>適正体重範囲：</b> ${minWeight.toFixed(1)} kg ～ ${maxWeight.toFixed(1)} kg<br>

        <table>
          <thead>
            <tr>
              <th>方式</th>
              <th>基礎代謝量 (kcal/日)</th>
              <th>推定消費カロリー (kcal/日)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>ハリスベネディクト式</td>
              <td>${bmrHarris.toFixed(0)}</td>
              <td>${tdeeHarris.toFixed(0)}</td>
            </tr>
            <tr>
              <td>Mifflin-St Jeor式</td>
              <td>${bmrMifflin.toFixed(0)}</td>
              <td>${tdeeMifflin.toFixed(0)}</td>
            </tr>
          </tbody>
        </table>
      `;
    });
  </script>
</body>
</html>
